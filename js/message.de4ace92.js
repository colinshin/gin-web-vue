(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["message"],{"1d11":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.table.loading,expression:"table.loading"}],ref:"searchForm",staticClass:"demo-form-inline",attrs:{inline:!0,model:e.table.form}},[a("el-form-item",{attrs:{label:"标题",prop:"title"}},[a("el-input",{attrs:{placeholder:"标题",clearable:""},on:{clear:e.doSearch},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.doSearch(t)}},model:{value:e.table.form.title,callback:function(t){e.$set(e.table.form,"title","string"===typeof t?t.trim():t)},expression:"table.form.title"}})],1),a("el-form-item",{attrs:{label:"内容",prop:"title"}},[a("el-input",{attrs:{placeholder:"内容",clearable:""},on:{clear:e.doSearch},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.doSearch(t)}},model:{value:e.table.form.content,callback:function(t){e.$set(e.table.form,"content","string"===typeof t?t.trim():t)},expression:"table.form.content"}})],1),a("el-form-item",{attrs:{label:"类型",prop:"type"}},[a("el-select",{attrs:{placeholder:"请选择消息类型",clearable:""},on:{clear:e.doSearch,change:e.doSearch},model:{value:e.table.form.type,callback:function(t){e.$set(e.table.form,"type","string"===typeof t?t.trim():t)},expression:"table.form.type"}},e._l(e.defaultConfig.types,(function(e){return a("el-option",{key:e.name,attrs:{label:e.label,value:e.name}})})),1)],1),a("el-form-item",{attrs:{label:"状态",prop:"status"}},[a("el-select",{attrs:{placeholder:"请选择消息状态",clearable:""},on:{clear:e.doSearch,change:e.doSearch},model:{value:e.table.form.status,callback:function(t){e.$set(e.table.form,"status","string"===typeof t?t.trim():t)},expression:"table.form.status"}},e._l(e.defaultConfig.status,(function(e){return a("el-option",{key:e.name,attrs:{label:e.label,value:e.name}})})),1)],1),a("el-form-item",[a("el-button",{attrs:{type:"primary",loading:e.table.loading},on:{click:e.doSearch}},[e._v(" 查询 ")]),a("el-button",{on:{click:function(t){return e.resetForm("searchForm")}}},[e._v(" 重置 ")])],1),a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:1.5}},[a("el-button",{attrs:{type:"primary",icon:"el-icon-view",disabled:e.table.batchReadBtnDisabled},on:{click:e.handleBatchRead}},[e._v(" 批量已读 ")])],1),a("el-col",{attrs:{span:1.5}},[a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",disabled:e.table.batchDeleteBtnDisabled},on:{click:e.handleBatchDelete}},[e._v(" 批量删除 ")])],1),a("el-col",{attrs:{span:1.5}},[a("el-button",{attrs:{type:"primary"},on:{click:e.handleAllRead}},[e._v(" 全部已读 ")])],1),a("el-col",{attrs:{span:1.5}},[a("el-button",{attrs:{type:"danger"},on:{click:e.handleAllDelete}},[e._v(" 全部清空 ")])],1)],1),a("el-table",{staticStyle:{width:"100%","margin-bottom":"20px"},attrs:{data:e.table.list,"row-key":"id",border:"",stripe:""},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),a("el-table-column",{attrs:{prop:"title",label:"标题",sortable:""}}),a("el-table-column",{attrs:{prop:"content",label:"内容"}}),a("el-table-column",{attrs:{prop:"type",label:"类型",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",[e._v(" "+e._s(e.getTypeTagLabel(t.row.type))+" ")])]}}])}),a("el-table-column",{attrs:{prop:"fromUsername",label:"创建人"}}),a("el-table-column",{attrs:{prop:"createdAt",label:"创建时间"}}),a("el-table-column",{attrs:{prop:"status",label:"状态",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{attrs:{type:e.getStatusTagType(t.row.status)}},[e._v(" "+e._s(e.getStatusTagLabel(t.row.status))+" ")])]}}])}),a("el-table-column",{attrs:{fixed:"right",label:"操作",align:"center",width:"220"},scopedSlots:e._u([{key:"default",fn:function(t){return[0===t.row.status?a("el-button",{attrs:{type:"primary"},on:{click:function(a){return e.handleRead(t.row)}}},[e._v(" 已读 ")]):e._e(),a("el-button",{attrs:{type:"danger"},on:{click:function(a){return e.handleDelete(t.row)}}},[e._v(" 删除 ")])]}}])})],1),a("el-pagination",{attrs:{"current-page":e.table.pageNum,"page-sizes":[1,5,20,50],"page-size":e.table.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.table.total,background:""},on:{"size-change":e.handlePagSizeChange,"current-change":e.handlePageNumChange}})],1)],1)},r=[],l=(a("a15b"),a("b0c0"),a("5530")),i=(a("96cf"),a("1da1")),o=a("d4ec"),c=a("bee2"),u=a("262e"),s=a("2caf"),p=a("9ab4"),d=a("60a3"),f=a("333d"),h=a("b32d"),b=function(e){return Object(h["a"])({url:"/message/all",method:"get",params:e})},g=a("afe9"),m=function(e){Object(u["a"])(a,e);var t=Object(s["a"])(a);function a(){var e;return Object(o["a"])(this,a),e=t.apply(this,arguments),e.defaultConfig={pageNum:1,pageSize:5,types:[{name:0,label:"私信消息"},{name:1,label:"通知消息"},{name:2,label:"系统消息"}],status:[{name:0,label:"未读",type:"danger"},{name:1,label:"已读",type:"success"}]},e.table={loading:!1,batchReadBtnDisabled:!0,batchDeleteBtnDisabled:!0,selection:[],list:[],pageNum:1,pageSize:5,total:0,form:{title:"",content:"",type:"",status:""}},e}return Object(c["a"])(a,[{key:"created",value:function(){this.getData()}},{key:"getData",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){var t,a,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.table.loading=!0,e.prev=1,t=Object(l["a"])(Object(l["a"])({},this.table.form),{},{pageNum:this.table.pageNum,pageSize:this.table.pageSize}),""===t.status&&delete t.status,""===t.type&&delete t.type,e.next=7,b(t);case 7:a=e.sent,n=a.data,this.table.list=n.list,this.table.pageNum=n.pageNum,this.table.pageSize=n.pageSize,this.table.total=n.total;case 13:return e.prev=13,this.table.loading=!1,e.finish(13);case 16:case"end":return e.stop()}}),e,this,[[1,,13,16]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"doSearch",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.getData();case 1:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"handleRead",value:function(e){this.batchRead([e])}},{key:"handleBatchRead",value:function(){this.batchRead(this.table.selection)}},{key:"batchRead",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(t){var a,n,r,l;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:for(a=[],n=0,r=t.length;n<r;n++)l=t[n],a.push(l.id);a.length>0&&g["a"].Send({type:3,data:{ids:a.join(",")}});case 3:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"handleAllRead",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:g["a"].Send({type:5});case 1:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}()},{key:"handleDelete",value:function(e){this.batchDelete([e])}},{key:"handleBatchDelete",value:function(){this.batchDelete(this.table.selection)}},{key:"batchDelete",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(t){var a,n,r,l,o,c,u=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:for(a=[],n=[],r=0,l=t.length;r<l;r++)o=t[r],a.push(o.id),n.push(o.title);a.length>0&&(c="确定要删除消息[".concat(n.join(","),"]吗, 此操作不可逆?"),this.$confirm(c,"请谨慎操作",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(i["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:g["a"].Send({type:4,data:{ids:a.join(",")}}),u.refresh();case 2:case"end":return e.stop()}}),e)})))));case 4:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"handleAllDelete",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){var t,a=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t="确定要清空消息吗, 此操作不可逆?",this.$confirm(t,"请谨慎操作",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(i["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:g["a"].Send({type:6}),a.refresh();case 2:case"end":return e.stop()}}),e)}))));case 2:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"resetForm",value:function(e){this.table.pageNum=this.defaultConfig.pageNum,this.table.pageSize=this.defaultConfig.pageSize;var t=this.$refs[e];t.resetFields(),this.getData()}},{key:"handleSelectionChange",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.table.batchReadBtnDisabled=0===t.length,this.table.batchDeleteBtnDisabled=0===t.length,this.table.selection=t;case 3:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"handlePagSizeChange",value:function(e){this.table.pageSize=e,this.doSearch()}},{key:"handlePageNumChange",value:function(e){this.table.pageNum=e,this.doSearch()}},{key:"getTypeTagLabel",value:function(e){for(var t=0,a=this.defaultConfig.types.length;t<a;t++){var n=this.defaultConfig.types[t];if(e===n.name)return n.label}return""}},{key:"getStatusTagType",value:function(e){for(var t=0,a=this.defaultConfig.status.length;t<a;t++){var n=this.defaultConfig.status[t];if(e===n.name)return n.type}return""}},{key:"getStatusTagLabel",value:function(e){for(var t=0,a=this.defaultConfig.status.length;t<a;t++){var n=this.defaultConfig.status[t];if(e===n.name)return n.label}return""}},{key:"refresh",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:setTimeout((function(){t.getData()}),500);case 1:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}()},{key:"unReadCount",get:function(){return g["a"].unReadCount}}]),a}(d["c"]);Object(p["a"])([Object(d["d"])("unReadCount")],m.prototype,"refresh",null),m=Object(p["a"])([Object(d["a"])({name:"Message",components:{Pagination:f["a"]}})],m);var y=m,v=y,k=(a("e5d7"),a("2877")),w=Object(k["a"])(v,n,r,!1,null,"7506c4ea",null);t["default"]=w.exports},"2fcb":function(e,t,a){},"333d":function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"pagination-container",class:{hidden:e.hidden}},[a("el-pagination",e._b({attrs:{background:e.background,"current-page":e.currentPage,"page-size":e.pageSize,layout:e.layout,"page-sizes":e.pageSizes,total:e.total},on:{"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t},"update:pageSize":function(t){e.pageSize=t},"update:page-size":function(t){e.pageSize=t},"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}},"el-pagination",e.$attrs,!1))],1)},r=[],l=a("d4ec"),i=a("bee2"),o=a("262e"),c=a("2caf"),u=a("9ab4"),s=a("60a3"),p=function(e,t,a,n){return e/=n/2,e<1?a/2*e*e+t:(e--,-a/2*(e*(e-2)-1)+t)},d=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)}}(),f=function(e){document.documentElement.scrollTop=e,document.body.parentNode.scrollTop=e,document.body.scrollTop=e},h=function(){return document.documentElement.scrollTop||document.body.parentNode.scrollTop||document.body.scrollTop},b=function(e,t,a){var n=h(),r=e-n,l=20,i=0;t="undefined"===typeof t?500:t;var o=function e(){i+=l;var o=p(i,n,r,t);f(o),i<t?d(e):a&&"function"===typeof a&&a()};o()},g=function(e){Object(o["a"])(a,e);var t=Object(c["a"])(a);function a(){return Object(l["a"])(this,a),t.apply(this,arguments)}return Object(i["a"])(a,[{key:"handleSizeChange",value:function(e){this.$emit("pagination",{page:this.currentPage,limit:e}),this.autoScroll&&b(0,800)}},{key:"handleCurrentChange",value:function(e){this.$emit("pagination",{page:e,limit:this.pageSize}),this.autoScroll&&b(0,800)}},{key:"currentPage",get:function(){return this.page},set:function(e){this.$emit("update:page",e)}},{key:"pageSize",get:function(){return this.limit},set:function(e){this.$emit("update:limit",e)}}]),a}(s["c"]);Object(u["a"])([Object(s["b"])({required:!0})],g.prototype,"total",void 0),Object(u["a"])([Object(s["b"])({default:1})],g.prototype,"page",void 0),Object(u["a"])([Object(s["b"])({default:20})],g.prototype,"limit",void 0),Object(u["a"])([Object(s["b"])({default:function(){return[10,20,30,50]}})],g.prototype,"pageSizes",void 0),Object(u["a"])([Object(s["b"])({default:"total, sizes, prev, pager, next, jumper"})],g.prototype,"layout",void 0),Object(u["a"])([Object(s["b"])({default:!0})],g.prototype,"background",void 0),Object(u["a"])([Object(s["b"])({default:!0})],g.prototype,"autoScroll",void 0),Object(u["a"])([Object(s["b"])({default:!1})],g.prototype,"hidden",void 0),g=Object(u["a"])([Object(s["a"])({name:"Pagination"})],g);var m=g,y=m,v=(a("34cc"),a("2877")),k=Object(v["a"])(y,n,r,!1,null,"2f4afb68",null);t["a"]=k.exports},"34cc":function(e,t,a){"use strict";var n=a("4601"),r=a.n(n);r.a},4601:function(e,t,a){},e5d7:function(e,t,a){"use strict";var n=a("2fcb"),r=a.n(n);r.a}}]);